# Abstract
Reliable fire severity mapping is a vital resource for fire scientists and land management agencies globally. Satellite derived pre- and post-fire differenced severity indices (dFSI), such as the differenced Normalised Burn Ratio (dNBR), are widely used to map the severity of large wildfires. Fire severity classification is commonly undertaken through the identification of severity class thresholds in dFSI. However, several shortcomings have been identified with severity classifications using dFSI, including poor delineation of low fire severity classes, and unsatisfactory performance when dFSI classification thresholds are applied to new landscapes. Our study assesses the performance of the Random Forest classifier (RF) for improving the accuracy of satellite based wildfire severity mapping across heterogeneous landscapes using Landsat imagery. We collected point based fire severity training data (n = 10,855) from sixteen large wildfires occurring across south-eastern Australia between 2006 and 2016. The predictive accuracy of fire severity classification using dNBR and the RF incorporating numerous spectral indices, was assessed using bootstrapping and cross validation. Image acquisition and index calculation for each fire was undertaken in Google Earth Engine (GEE). Results of the bootstrapping validation show that the RF classifier had very high classification accuracy (> 95%) for unburnt (UB), crown scorch (CS) and crown consumption (CC) severity classes, and high classification accuracy (> 74%) for low severity classes (crown unburnt, CU; partial crown scorch, PCS). The RF classification outperformed the dNBR classification for all severity classes, increasing classification accuracy by between 6%–21%. Cross validation using independent fires produced similar median classification accuracy as the bootstrapping validation, though the RF classification of CU was substantially reduced to ~55%. dNBR, dNDWI and dNDVI were the three most important variables in the RF model. The Landsat satellite platform used to derive the indices had little effect on classification accuracy. Maps produced using the RF classifier in GEE had similar spatial patterns in fire severity classes as maps produced using time-consuming hand digitisation of aerial images. GEE was found to be a highly efficient platform for image acquisition, processing and production of severity maps. Our study shows that fire severity mapping using RF classifiers provides a robust method for broad scale mapping of fire severity across heterogeneous landscapes. Furthermore, the GEE-based classification framework supports the operational application of this approach in a land management agency context for the rapid production of fire severity maps.

# Keywords:
Wildfire severity, Landsat, Temperate forests, Normalised Burn Ratio, Machine learning, Google Earth Engine

# Introduction
Fire is one of the dominant disturbances across terrestrial ecosystems globally (Bowman et al., 2009). Fire severity is defined as the loss of above- and below-ground organic matter and is correlated with fire intensity within plant communities with similar vegetation structure (Hammill and Bradstock, 2006; Keeley, 2009). Fire severity is an important component of the fire regime, as it influences the post-fire response of plant and animal communities (Bennett et al., 2016; Smucker et al., 2005), alters erosion and water quality (Doerr et al., 2006; Nolan et al., 2015) and influences the likelihood of fire suppression by firefighting crews (Bradstock et al., 2010). Accurate fire severity mapping provides crucial information for policy makers, land managers and researchers (Eidenshink et al., 2007), as well as staff involved in incident control (e.g. post-fire impact assessments). In particular, fire severity mapping can facilitate: (i) burnt area emergency response, (ii) assessment of decadal trends in fire regimes, (iii) assessments of the effectiveness of fire management strategies, (iv) improved understanding of fire behaviour, and (v) insight into fire regime effects on biota and ecosystem processes. Broad scale fire severity mapping predominantly uses data from satellite imagery and aerial photography, although systematic and reliable mapping of severity is not a common process in many countries.

Fire severity mapping using satellite imagery has largely relied on the pre- and post- fire differencing of a spectral index (SI) to derive a single differenced fire severity index (dFSI). The rationale behind this approach is that pre- and post-fire differences in the SI will reflect the degree of environmental change due to fire, and hence fire severity. dFSI may be used as a continuous measure of fire severity, though often dFSI are classified into environmentally meaningful fire severity classes. The preferred SI used to derive the dFSI will vary depending on the ecosystem characteristics or features of interest (e.g. foliage, soil). dFSI derived from SI sensitive to foliage health and cover, such as the differenced Normalised Burn Ratio (dNBR), tend to show a good correlation with field derived measures of fire severity. Consequently, dNBR is a widely utilised index for fire severity mapping, and is favoured by many fire management agencies. Despite its widespread use, dNBR has been shown to be sub-optimal for describing fire severity in some instances.

The approach of fire severity classification using a single dFSI has a number of limitations that restrict the application of the method across space and time. First, dFSI values are not comparable across structurally distinct vegetation classes (e.g. forest and shrubland). This is because vegetation structure influences SI values, hence the maximum value of a dFSI will be determined by pre-fire vegetation state. Consequently, accurate severity classification with a single dFSI will require adjustments to the thresholds for each vegetation type examined, which reduces the broad scale usefulness of the approach. Second, low fire severity classes, or classes that are a composite of fire severity effects (e.g. partial crown scorch), can be difficult to distinguish with a single dFSI. This partially reflects limitations in the type of change that a single SI can detect and difficulties in distinguishing pixels with mixed cover types. Fire alters a range of ecosystem properties, including foliage cover, health and moisture content and the amount of bare soil and charcoal; each which influence spectral reflectance. Classification methods using empirical models that can incorporate information from multiple dFSI sensitive to a range of environmental conditions as well as SIs related to pre-fire vegetation conditions may facilitate improved fire severity classification Physical based models, such as Radiative Transfer Models that simulate spectral signatures at the leaf and canopy scale, have also been successfully used to predict burn severity (e.g. Composite Burn Index) from satellite imagery, and may outperform dFSI such as dNBR.

Machine learning (ML), defined as the application of statistical techniques and algorithms for identifying patterns in data and making predictions from those patterns, are now commonly applied in remote sensing classification. ML techniques perform better than simple classifiers in dealing with complex interactions between scene complexity, scale and aggregation and have improved discrimination of classes in heterogeneous landscapes (typical in remote sensing) with low inter-class separability and high intra-class variability. Random Forest (RF) is a popular machine learning technique, commonly applied in remote sensing. Frequently cited advantages of RF classifiers over other machine learning techniques include its excellent classification results and processing speed, its ability to handle noise and outliers in complex measurement space, and characterize complex variable interactions. The RF classifier is well suited to addressing fire mapping problems, as it can consider multiple environmental variables simultaneously, and has been found to be better suited for fire severity mapping than other ML classifiers. Despite the commonly cited advantages of ML classifiers like RF, they have rarely been utilised for fire severity classificatio.

Studies assessing the utility of ML classification techniques for fire severity mapping have been limited by the size and extent of training and validation data, and have not performed cross validation using fires that were not included in training data. Consequently, the true utility of ML classifiers, such as RF, as a tool to reliably produce fire severity mapping across heterogeneous landscapes has not been assessed. The aim of our study was to:
- assess the performance of RF for classifying fire severity using several indices derived from moderate resolution (30 m) Landsat imagery;
- compare the RF classification to a single index classification using dNBR, both within and outside the set of training fires;
- assess the relative importance of different indices in improving fire severity classification;
- examine how additional sampling effort from new fires can improve RF classification accuracy of these fires.

# Methods
## Study area
The study included sixteen large wildfires, ranging from 1800 to > 120,000 ha in extent, that occurred between 2006 and 2016 in Victoria, Australia (Fig. 1). The wildfires used in this study were selected based on the availability of (i) high resolution (≤35 cm) visible and infrared aerial photography captured shortly after the fire ignition date (i.e. within ~2-3 months) and (ii) Landsat imagery to produce preand post-fire cloud free mosaics. Fire severity was spatially heterogeneous within the wildfire perimeters, covering the range of fire severity classes distinguishable with aerial photography (Table 1, SM1). The fires occurred in a range of vegetation communities including heathlands (i.e. shrub dominated communities), open forests and woodlands, tall forests and pine plantations. Grass and sedge dominated communities were excluded from the study, as were arid and semi-arid woody vegetation communities.
## Fire severity data
Fire severity data used in this study for classifier training and validation was derived using aerial photo interpretation and digitisation. High resolution visible and infrared aerial photography has been effectively used to distinguish fire severity classes (Table 1) in Australian forests, woodlands and shrublands, with high correlations being observed between photo and field based measures of fire severity. Five fire severity classes were identified from aerial photographs, based on levels of scorch and consumption of the crowns of the canopy and understorey vegetation layers. These classes reflect different degrees of organic matter loss (i.e. foliage and litter consumption) and are indicative of the potential for fire suppression in eucalypt forests and woodlands. These five fire severity classes are currently used for routine mapping using aerial photography conducted by Victoria's Department of Environment, Land, Water and Planning (DELWP). Similar fire severity classification schemes based on organic matter loss have been used elsewhere in Australia and Internationally.

Post-fire infrared aerial imagery was obtained from DELWP for each of the sixteen study fires. Large patches (> 100 m wide) of each fire severity class were identified across each wildfire and digitised in ArcMap by one observer, to ensure there was no inter-observer bias. Unburnt patches were generally identified outside the fire perimeter, typically within 2000 m of the fire edge, as large patches of unburnt vegetation within the fire perimeter were not always present. Digitised polygons covered a broad range of environmental conditions (e.g. vegetation type, logging history, fire history) within each wildfire perimeter to ensure a range of conditions were included. The scale of the Landsat pixel (30 m) was considered when assigning areas to fire severity classes, by placing size and spacing restrictions on fire severity patterns. In areas assigned to the partial crown scorch (PCS) class, which is a mixture of unburnt crown (CU) and crown scorch (CS) (Table 1), the distance between patches of CU and CS could not exceed ~25 m to ensure a composite of fire severity classes would occur within a Landsat pixel. In areas assigned as unburnt (UB), CU and CS, patches of non-target severity classes could not be greater than ~5 m radius and were typically > 25 m apart to ensure they didn't occupy > 10% of a Landsat pixel. Distances were measured in ArcMap using the Measure tool.

Random sample points were generated for model training within each digitised severity polygon, such that points were > 50 m from the polygon edge, to ensure we were sampling Landsat pixels that fell entirely within the target severity class. Sample points were located > 85 m apart to ensure separation of at least one Landsat pixel and to minimise the effect of spatial autocorrelation. A total of 10,855 points were generated across the sixteen fires (Table 1), which included samples of each fire severity class across the majority of fires.

## Remotely sensed indices
Five commonly used SI derived from Landsat imagery were investigated as potential predictors of fire severity in this study, including the Normalised Burn Ratio (NBR), Normalised Difference Vegetation Index (NDVI), Normalised Difference Water Index (NDWI), Visible Atmospherically Resistant Index (VARI) and the Burn Area Index (BAI). These SI were selected because they are commonly used for fire detection and severity mapping, due to their sensitivity to a range of ecosystem characteristics that are altered by fire, including foliage health and cover (NBR, NDVI), foliage moisture content (NDWI, VARI) and charcoal (BAI). Pre- and post-fire SI differencing was used for NBR, NDVI, NDWI and VARI. BAI was calculated using only post-fire images. Pre- and post-fire SI values were also calculated for NBR, NDVI, NDWI and VARI.

Google Earth Engine (GEE) was used for image acquisition and processing, and the derivation of spectral indices. GEE is a cloud-based remote sensing data processing and analysis platform, which combines public access remote sensing and geospatial data, with high-performance parallel computation service. Landsat surface reflectance products, which are acquired from the United States Geological Survey (USGS), were used in our study. All scenes have been georeferenced and terrain correctedto a level deemed satisfactory for research purposes. The surface reflectance product uses the Landsat Ecosystem Disturbance Adaptive Processing System (LEDAPS) algorithm to correct for atmospheric effects on reflectance. The surface reflectance product also contains a cloud, cloud shadow and water mask (CFmask), which can be used to mask out water bodies or areas affected by clouds.

Fire start and finish dates were derived from digital archives (i.e. fire history mapping, online reports), or estimated using Landsat or MODIS imagery. Post-fire imagery acquired within the ~70 days following the burn finish date was considered suitable for the post-fire SI, as previous work has shown that the fire severity signal in Australian woodlands and heathlands begins to deteriorate beyond this window. Imagery acquired within 60 days prior to the fire start date was considered suitable to calculate the pre-fire SI, to minimise seasonal differences on the pre- and post-fire SI. If single cloudfree pre- and post-fire imagery were available within the sampling window defined above, they were used to calculate indices, with preference given to the cloud free images captured closest to the fire start and end dates. Composites of images were used when suitable cloud free images were not available. Composites were derived by calculating SI for each image falling within the desired date range, with cloud and shadow affected pixels being masked out of each image using the CFmask. The shortest possible window either side of the fire start and end dates was used to obtain a cloud free composite. Water was masked out of pre-fire images using the CFmask, but not post-fire images, as the CFmask often confused severely burnt patches as water. A median index value was then calculated from all suitable pixels to derive the composite. Fires occurring prior to February 2013 used both Landsat 5 TM and Landsat 7 ETM+ imagery, while those occurring after this time used only Landsat 8 OLI/TIRS imagery. Landsat 8 imagery was not composited with Landsat 7 imagery due to subtle differences in band widths.

## Modelling and analysis
### Random forest
RF uses bootstrap aggregated (bagging) sampling of training data to construct decision trees (base classifiers), which represent a set of diverse base classifiers, which when combined into an ensemble are used to assign a class (prediction) to a response variable through voting (in the case of categorical data) or by averaging (for continuous variables). In constructing each decision tree in the RF, at every node (split point), a randomly selected subset of model predictor variables (parameter mtry) is evaluated for partitioning training data into increasingly homogenous subsets, the predictor variable used to split the training data is that which results in the highest increase in data uniformity. The parameter ntree represents the number of decision trees (base classifiers) in the RF ensemble.

### Comparison of classification approaches and assessment of index importance
We initially trialled the RF classification using different combinations of indices, including all indices, without post-fire FSI and without dFSI. Estimates of error rates for the different models were all within 0.4%, indicating little difference in model classification accuracy. For the purpose of parsimony, we focused on a RF model containing nine SI, including the dFSI (NBR, NDVI, NDWI, VARI) and their pre-fire index values and BAI. The satellite identifier (i.e. Landsat 8 or Landsat 5/Landsat 7) was included to determine if the narrower Landsat 8 band widths affected classification. The number of trees was set to 500 and number of predictor variables at each node used was the square root of the number of variables used in the model. Bootstrapping was used to obtain estimates of the median and variance in classification accuracy of the RF classifiers. A subset of 70% of the data was randomly selected without replacement and used to train the RF classifier. The random selection was stratified by fire severity class to ensure that data used for training and validation has equal proportions of each severity class. The trained RF was used to classify the remaining 30% of the dataset in order to provide independent model validation. The process was repeated randomly 1000 times and the proportion of correctly classified data points in the validation dataset was recorded. Classification accuracy of the bootstrapped RF classifiers was graphically presented using violin plots, which depict both a boxplot and the probability density of the data.

Fire severity classification using single dFSI typically uses thresholds in the index to identify fire severity classes. We trialled two approaches to perform this classification: (i) by calculating mean dFSI values for each fire severity class, and using the mid-points between the mean values of the ordered severity classes as thresholds for classification; and (ii) using ordinal regression. Classification performance for each dFSI was assessed using the bootstrapping approach described above. dNBR was found to have the highest classification accuracy (~80%) of the dFSI using both approaches. We used the conceptually simple midpoint threshold dNBR classification as the baseline to compare the RF classification against. The midpoint threshold dNBR classification had similar overall classification accuracy as the ordinal regression approach (78.9% and 80.8% respectively). Differences in the accuracy of the RF and dNBR classification were statistically assessed for each severity class by extracting the 95% confidence intervals (CI) from the bootstrapped data. Non-overlapping CI were determined to be significantly different.

A leave one fire out cross validation was undertaken for the RF classifier and the dNBR method by excluding one fire from the training dataset and using all the sample points from that fire for validation. We repeated this process so that each fire was used only once for validation. In each validation fire, classification accuracy was only assessed for fire severity classes that had > 20 observations, to ensure reliable accuracy estimates were obtained. The accuracy of the RF and dNBR classification was graphically displayed using violin plots. A Wilcoxon signed rank test was used to test for differences between the accuracy of the RF and dNBR classifiers within fire severity classes. We assessed how the addition of sampling points from a validation fire influenced the accuracy of the RF classifier, by incrementally adding data from a validation fire (10, 20, 30, 40, and 50 points per fire severity class) to the training dataset and revalidating the predictive accuracy of the RF classifier. The validation process was only conducted using four wildfires with a minimum of 75 data points per severity class, to facilitate the removal of up to 50 points per severity class from the validation dataset. Samples included in the training data were taken randomly without replacement from the validation fire and this process was only repeated 200 times to reduce processing time. The full dataset was used to train the RF classifier and the Gini impunity criterion was extracted to identify the relative influence of different indices on fire severity classification.

We assessed the influence of the top five indices (I1–I5) by fitting five models that were derived by incrementally adding variables based on the Gini importance. The bootstrapping process described above, where 70% and 30% of the data was used for model training and validation, was used to estimate model accuracy.

Statistical analysis was undertaken in R. Random Forest analysis was undertaken using the randomForest package. Classification matrices were derived using the caret package. Violin plots were produced using the package vioplot.

### Fire severity mapping
Classified fire severity maps were produced in GEE using the Random Forest classifier to provide visual examples of model performance. The number of trees was set to 100, as the modelling described above showed that 100 trees was sufficient to produce a stable error rate. The number of predictor variables supplied to each node equalled the square root of the number of variables in the model. Maps produced in GEE were visually compared to available severity maps derived from digitised aerial photographs.

# Results
The RF model showed a high degree of classification accuracy for the bootstrapping cross validation. Median classification accuracy was 95% or greater for the unburnt, crown scorch (CS) and crown consumption (CC) fire severity classes and ~75% for the crown unburnt (CU) and partial crown scorch (PCS) classes (Fig. 2). The RF model had significantly (P < 0.05) greater classification accuracy than the ΔNBR threshold classification for all fire severity classes (Fig. 2), and showed good improvement (10–20%) in classification accuracy relative to ΔNBR for the UB, CU, PCS and CS classes (Fig. 2, Table 3). Relative to the ΔNBR threshold classification, the RF approach reduced misclassification between all adjacent severity classes (Table 3). Most notable were the reductions in misclassification between the UB and CU classes, CU and PCS classes, and the PCS and CS classes (Table 3).

The median predictive accuracy of the RF classifier for the leave one fire out cross validation (Fig. 3) was similar to values reported for the bootstrapping cross validation (Fig. 2), suggesting that the RF classifier will likely have high predictive accuracy when the model is applied to new fires. The exception was the CU class, which had a median accuracy of ~55% when applied to new fires (Fig. 3). However, the range of predictions for any fire severity class increased when RF was applied to new fires (i.e. the probability density plots increase in length; Fig. 2 vs Fig. 3), indicating that severity classes within some fires were poorly predicted. This was particularly evident for the CU and PCS fire severity classes (Fig. 3). Relative to the dNBR classification, the RF classifier had 5%–15% greater median predictive accuracy for the PCS, CS and CC classes (Fig. 3). Both approaches performed poorly for the CU class (Fig. 3). The addition of training data from the validation fire improved classification accuracy of the RF classifier in the CU class (Fig. 4), but had little effect on the other classes. The addition of 50 new training data points increased the median accuracy in the CU class by ~20% (Fig. 4), with median accuracy approaching that of the initial validation presented in Fig. 2.

The Gini statistic for the RF classifier identified dNBR as the variable with the greatest influence on classification accuracy, with dNDWI and dNDVI also having high importance (Fig. 5). The satellite platform used to derive the indices had little effect on classification accuracy (Fig. 5), suggesting that the small differences in bandwidth were unimportant. There was little difference in the predictive accuracy of the RF classifier using only dNBR versus the RF using the full suite of indices for CC (Fig. 6). Classification accuracy for the CU and PCS classes was poor when only using dNBR, and improved by > 20% with the inclusion of additional dFSI, with dNDWI and dNDVI being particularly influential (Fig. 6). The addition of dNDWI improved classification accuracy of UB and CS classes by ~10% (Fig. 6). RF classification accuracy using only dNBR (72%) was lower than classification accuracy with dNBR thresholds.

Example maps produced using Landsat imagery with the RF classifier in GEE showed comparable patterns in fire severity classification to hand digitisation of aerial photographs (Fig. 7, S5).

# Discussion
Our paper provides one of the first robust assessments of the utility of the RF algorithm for wildfire severity mapping relative to single dFSI methods that are widely used by fire management agencies globally. Fire severity classification using the RF classifier showed significant improvement relative to classification using only dNBR, with a ~10% increase in overall classification accuracy when training data was provided for a fire. Significant improvements in classification accuracy were observed for all fire severity classes (~6%–21%), with considerably less misclassification between low to moderate fire severity classes (i.e. UB, CU, PCS, CS). Based on these findings, we recommend that the RF classifier, or similar classification techniques that can incorporate many spectral indices, be used for fire severity classification in favour of single dFSI approaches.

Previous assessments of ML techniques for fire severity classification have shown improved classification accuracy relative to single dFSI, suggesting that ML classifiers are likely to improve severity classification when applied to most ecosystems. Our results suggest that improved classification with the RF classifier largely arose from the ability to incorporate many dFSI sensitive to a range of environmental attributes (i.e. foliage cover, foliage moisture and charcoal) (Figs. 5, 6). The addition of pre-fire SI to provide context of vegetation states led to additional, albeit smaller, improvements. The value of incorporating pre-fire SI has been demonstrated previously for fire severity classification across structurally diverse ecosystems.

The RF and dNBR approaches displayed high classification accuracy of crown fires, irrespective of whether the training data included information from the validation fire(s) (Fig. 2) or not (Fig. 3). This was expected as previous research has shown dNBR is very effective for identification of high severity fire. dNBR is highly sensitive to leaf area index, which shows large pre- and post-fire differences in areas subjected to crown consuming fires. In low to moderate fire severity classes, changes to live foliage cover are more subtle, and the effects of structural heterogeneity of vegetation will create noise in the spectral signal, potentially reducing classification accuracy when using a single dFSI. Our results show that incorporating additional dFSI substantially improves classification accuracy in the low - moderate fire severity classes. The dNDWI, which is sensitivity to foliage moisture content, was particularly important for the classification of low - moderate fire severity classes (UB, CU, PCS, CS; Fig. 6). Stem heating can lead to cavitation and deformation of stem xylem, reducing transfer of water to foliage, which may explain why a SI sensitive to foliage moisture content was useful in delineating low severity classes.

The need to improve the accuracy of mapping for ecologically important fire severity classes has been identified previously. Unburnt refuges are of particular importance for the persistence and post-disturbance recovery of plant and animal communities, and consequently are of high conservation value. The RF approach had high median classification accuracy (> 95%) for unburnt vegetation, which is similar to results reported for fires in the north-western United States. Our study and that of Meddens et al. show that the RF classifier approach to fire severity mapping substantially improves the classification accuracy (~10%) of unburnt vegetation relative to threshold classifications using only dNBR. Improved fire refuge mapping will facilitate greater understanding of fire refuge dynamics, and the processes driving the spatial and temporal patterns of this important landscape feature.

The intra-fire validation approach used in our study highlights that the ability of the RF algorithm to classify the severity of entirely novel fire events may be overestimated if validation is only performed on data derived from within the training fires (Figs. 2; 3). This was particularly evident for the lower fire severity classes (CU, PCS), which present the greatest classification challenge. The issue of reduced predictive performance of RF when applied to independent datasets has been observed previously. Past studies assessing the predictive accuracy of ML classifiers for fire severity classification have not performed cross validation on new fire events, and therefore may overestimate the predictive performance of the respective approaches. However, our work shows that the median classification accuracy of the RF algorithm on new fires still exceeded 95% for the UB, CS and CC fire severity classes, and was marginally better than the dNBR classification for the PCS class, indicating that the approach represents an improvement over traditional classification methods. Furthermore, we found that the addition of a small amount of training data (30–50 points) from the target fire could markedly improve the performance of the RF classifier for low fire severity classes (e.g. CU).

Our study found very high classification accuracy using a small set of spectral indices that are known to correlate well with environmental characteristics that are modified by fire (Table 2). The ‘optimal’ set of spectral indices for RF classification will vary depending on ecosystem characteristics. For example, our results, and the work of others, suggest that incorporating indices that are sensitive to change in foliage cover and moisture content will be particularly useful for severity mapping in forest ecosystems with relatively continuous vegetation cover. However, in ecosystems with low vegetation cover, such as open woodlands and shrublands, fire severity may not correlate as well with indices sensitive to change in foliage (e.g. dNBR, dNDVI, dNDWI). In the absence of pre-fire imagery, classification may be enhanced through the use of a broader suite of post-fire fire-specific indices, such as Normalised Burn Ratio Thermal, VI6T, Mid-Infrared Burn Index and Char Soil Index, which have been found to perform well for burnt area mapping and in some instances fire severity classification.

Although our study utilised classified fire severity data, the RF approach can also be applied to continuous measures of fire severity, such as the Composite Burn Index (CBI). RF has produced better fits to CBI data than regression techniques utilising spectral indices. However, it is not clear whether RF will result in improved fire severity prediction relative to sophisticated simulation approaches, such as Radiative Transfer Models, which have been shown to have higher correlation with CBI than indices such as dNBR. A key benefit of the RF approach presented in our study is that it only relies on training data and satellite derived spectral data, whereas simulation models such as RTM require additional parameterisation using field derived spectral properties of the environment (e.g. soil, charcoal, vegetation). The parameterisation of RTMs can be challenging, and this may limit the uptake of these models by management agencies undertaking fire severity mapping. However, the benefit of RTMs is that they are physical models, thus offering greater generality than empirical models such as RF.

Spatial autocorrelation is an inherent feature of fire severity data, and may lead to inflated predictive accuracy in RF models. The nested sampling design used in our study, whereby sample points were generated inside polygons of homogeneous fire severity, artificially creates spatial autocorrelation, thus we could not meaningfully examine this in our study. Few studies have examined spatial autocorrelation of fire severity in Australian temperate forests, though the scale at which spatial autocorrelation is present can be large (~500 m) for crown consuming fires, which generally occur during extreme fire weather events. This distance decreases for lower fire severity classes (e.g. ~200 m when crown scorching fires are considered), which generally occur under benign weather conditions and are influenced more so by topography and fuels. We used a minimum spatial separation of 85 m between data points, which is similar to other studies, and is likely sufficient spacing for low fire severity classes. Inflated predictive accuracy due to spatial autocorrelation is therefore only likely to be an issue for the CC severity class. We found that the RF model had high classification accuracy of CC (> 90%; Fig. 3) when applied to fires that had been held out of the training dataset, indicating that spatial autocorrelation was likely having little effect on the predictive performance of the RF model.

GEE provides an ideal platform for the rapid production of accurate fire severity maps using the RF classifier (Fig. 7), especially given the large volume of data, high level of data curation, and the computational efficiencies. The application of the RF classifier in the GEE platform rapidly produced and exported (i.e. < 15 mins processing time) severity maps for large wildfires (10000–100,000 ha). These maps had similar spatial patterns in fire severity classes as maps produced using time-consuming hand digitisation of aerial images. GEE and the embedded RF classifier are well suited to routine acquisition and continued refinement of fire severity mapping using Landsat and other moderate resolution sensors with regular return intervals (e.g. Sentinel). The capacity for the RF classifier to improve with the addition of new training data will facilitate constant refinement of predictions over time. The development of a graphical user interface (GUI) to facilitate the extraction of spectral indices, validation of mapping and the production of fire severity maps will likely be necessary to increase the accessibility of this technique to non-technical users within fire management agencies.

We provide a framework for the integration of the RF mapping approach into fire management operations to routinely produce and improve fire severity maps (Fig. 8). The approach outlines a workflow for (i) the production of fire severity maps following fires, (ii) routine collection of fire severity data for initial map validation and necessary training, and (iii) continued assessment of the classifier accuracy to assess the need for the collection of additional training data (Fig. 8). The costs associated with the acquisition of training and validation data derived from field measures or aerial photography may limit the number of fires that can be sampled for training and validation purposes. Thus, it may only be feasible for training and validation to be performed for a subset of wildfires. Collation of existing field derived fire severity datasets (e.g. CBI) could be used for the training and validation of a base RF model in some instances. Additionally, the rising popularity of drones and other unmanned aerial vehicles for the acquisition of aerial imagery will likely reduce the costs of data collection in the future.

# Conclusions
Accurate fire severity mapping is critical to improving understanding of changes to fire regimes over space and time, the effectiveness of fire management actions, validation and refinement of fire behaviour models and better understanding of ecological effects of fire severity. From a land management perspective, the rapid production of fire severity maps enables timely and cost-effective recovery, rehabilitation and restoration efforts. We demonstrate that the use of a RF classifier, with thoughtfully selected dFSI and pre-fire SI, leads to improved classification accuracy of fire severity data products, relative to widely adopted approaches using only a single dFSI, such as dNBR. In particular, the ability of the RF classifier to improve the discrimination of low and moderate fire severity classes (i.e. CU, PCS, CS) will be of considerable advantage for both ecological and fire behaviour studies. Improvements to classifier accuracy will lead to more useful classifications of recent fires, as well as increased accuracy of fire severity classifications for previous fire events. These improvements will aid post-fire management response and provide the opportunity for refining our understanding of wildfire behaviour and ecological responses to fire. The extensive archive of Landsat data in GEE also means this framework can be applied to more accurately and consistently map historic wildfire severity, thus improving fire history archives.

# Acknowledgements
Funding for the project was provided by the Forest, Fire and Regions branch of the Department of Environment, Land, Water and Planning (DELWP). Post fire aerial imagery and fire history data was provided by the Department of Environment, Land, Water and Planning. We thank Matt White and Dr. Gabriele Caccamo for providing comments on an earlier draft of this paper. The manuscript was greatly improved by the comments of several anonymous reviewers.


